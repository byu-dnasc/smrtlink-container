root@aa1c904e6942:/opt/pacbio# su smrtanalysis -c "./smrtlink_12.0.0.177059.run --rootdir $SMRT_ROOT"
Starting smrtlink-release_12.0.0.177059 self-extraction...
Creating install directory (/opt/pacbio/smrtlink/install/smrtlink-release_12.0.0.177059)...
Extracting smrtlink-release_12.0.0.177059...
Invoking smrtlink-release_12.0.0.177059 install...

Detected Total Memory: 12884901888 bytes (from DirectMap, meminfo)

Extracting bundles...
  Extracting smrtinub bundle....
Starting smrtinub-release_12.0.0.177059 self-extraction...
Creating install directory (/opt/pacbio/smrtlink/install/smrtlink-release_12.0.0.177059/bundles/smrtinub/install/smrtinub-release_12.0.0.177059)...
Extracting smrtinub-release_12.0.0.177059...
Invoking smrtinub-release_12.0.0.177059 install...
Pacific Biosciences SMRT InstallerNub Batch Installer (smrtinub-release_12.0.0.177059)
  Extracting smrttools bundle....
Starting smrttools-release_12.0.0.177059 self-extraction...
Creating install directory (/opt/pacbio/smrtlink/install/smrtlink-release_12.0.0.177059/bundles/smrttools/install/smrttools-release_12.0.0.177059)...
Extracting smrttools-release_12.0.0.177059...
Invoking smrttools-release_12.0.0.177059 install...
Pacific Biosciences SMRTAnalysis Batch Installer (smrttools-release_12.0.0.177059)
Checking for user/group/other readability...
Checking runtimebin.log writability...
  Extracting smrtlink-analysisservices-gui bundle....
Starting smrtlink-analysisservices-gui-release_12.0.0.177059 self-extraction...
Creating install directory (/opt/pacbio/smrtlink/install/smrtlink-release_12.0.0.177059/bundles/smrtlink-analysisservices-gui/install/smrtlink-analysisservices-gui-release_12.0.0.177059)...
Extracting smrtlink-analysisservices-gui-release_12.0.0.177059...
Invoking smrtlink-analysisservices-gui-release_12.0.0.177059 install...
Pacific Biosciences SMRTLink Analysis Services GUI Batch Installer (smrtlink-analysisservices-gui-release_12.0.0.177059)
System sanity check...
  Checking locale...
  Checking uname...
  Checking libc...
  Checking mount points...
  No hung mount points detected.


                         PacBio SMRT Link Installer
                     (smrtlink-release_12.0.0.177059)



----- Part 0 of 10: System Prerequisite Check -----

Checking system configuration against minimum memory, processor and
user limit (ulimit) requirements.  SMRT Link requires at least 32
processors and 64GB of memory.  The soft user limits when starting
SMRT Link services must be at least 8192 for open files ('ulimit -Sn')
and 8192 for max number of processes ('ulimit -Su').

  Checking requirements...

    System Physical Memory (min: 64):    12.00 GB (12582912 kB)   [ERR]
    Number of Processors   (min: 32):        8                    [ERR]

    Open Files User Limit ('ulimit -n'):
      Soft Limit (min: 8192):             1024                    [ERR]
      Hard Limit (min: 8192):          1048576                    [OK]

    Open Files User Limit ('ulimit -u'):
      Soft Limit (min: 8192):        unlimited                    [OK]
      Hard Limit (min: 8192):        unlimited                    [OK]


  These errors may not be critical, but can affect SMRT Link performance:

      ERROR!  Minimum 'System Physical Memory' requirement not met.
      ERROR!  Minimum 'Number of Processors' requirement not met.

  This error WILL prevent smrtlink services from starting:

      ERROR!  Minimum 'Open Files' soft limit requirement not met.

Continue the installation? [Y/n]: Y

----- Part 1 of 10: SMRT Link User ----

It is recommended to run this script as a designated SMRT Link
user (e.g. smrtanalysis) who will own all smrtpipe jobs and daemon
processes.

Current user is 'smrtanalysis' (primary group: smrtanalysis)

Use the 'smrtanalysis' as the SMRT Link user? [Y/n]: Y

Using install user (computed): smrtanalysis
Using install group (computed): smrtanalysis
Using smrtlink uuid (computed default): 28b4c51e-235b-4551-abf3-e7c2ce53452d


----- Part 2 of 10: SMRT Link Server DNS -----

The DNS name of the SMRT Link host server is used for creating SMRT
Link URLs (e.g. http://smrtlink.example.com:9090), ensuring
an SSL certificate will validate.  If the Domain Name System (DNS)
does not resolve to the expected address, then an IP address must
be used.

Detecting DNS names...

Pick an option:
    1) aa1c904e6942 (unverified, no dns entry found)
    2) Specify an alternate DNS name
Choice [1]:

Using dnsname (selected interactively): aa1c904e6942


----- Part 3 of 10: SMRT Link Setup  ----

The SMRT Link UI and SMRT Link Services require one port each for
proper operation.  The SMRT Link UI port serves to redirect from
an unencrypted http connection to the login page using secure https.
The SMRT Link Services port is needed for internal access to the
SMRT Link webservices API.  Select port numbers which do not
conflict with any other process.

  Enter the SMRT Link UI (http) port [9090]:
  Enter the SMRT Link Services port [9091]:

Memory settings must be preset for SMRT Link.  By default, the
initial (-Xms) and maximum (-Xmx) Java heap sizes are set to the
same values.  The default for SMRT Link services is 25% of the
total memory with a maximum of 32768 MB.  Using the default value
is recommended.

  Enter the SMRT Link Services initial memory (in MB) [3072]:
  Enter the SMRT Link Services maximum memory (in MB) [3072]:

Using UI port (default, accepted): 9090
Using services port (computed default, accepted): 9091
Using services initial memory (computed default, accepted): 3072
Using services maximum memory (computed default, accepted): 3072


----- Part 4 of 10: Database Setup  -----

The SMRT Link Services use a database which need access to a
network port and a directory to store database data files.

The port will only be used to access the database from the SMRT Link
install host (localhost).  Select a port number which does not
conflict with any other process.

The database data directory should be located on a high performance
file system.  Typically, a local (not shared) disk partition.

  Enter the SMRT Link Database port [9095]:
  Enter the full path to the 'db_datadir' directory [/opt/pacbio/smrtlink/userdata/db_datadir.default]:
  Directory '/opt/pacbio/smrtlink/userdata/db_datadir.default' does not exist.  Create it? [Y/n]: Y

    Creating directory '/opt/pacbio/smrtlink/userdata/db_datadir.default'...

Using SMRT Link Database port (computed default, accepted): 9095
Using Database data dir (computed default, accepted): /opt/pacbio/smrtlink/userdata/db_datadir.default


----- Part 5 of 10: Cromwell Server Setup  ----

The Cromwell Workflow Engine Server manages the workflow for SMRT
Analysis jobs.  It requires a single port for proper operation.
Select a port number which does not conflict with any other process.

  Enter the Cromwell Server port [9096]:

Using Cromwell port (computed default, accepted): 9096


----- Part 6 of 10: Site-specific Directories Setup  -----

SMRT Link makes use of the following site-specific directories:

    jobs_root
    tmp_dir

jobs_root - This directory stores job output from the SMRT Analysis
            module of SMRT Link.  This directory may require
            a large amount of disk space (> 15TB, for example).

  Enter the full path to the 'jobs_root' directory [/opt/pacbio/smrtlink/userdata/jobs_root.default]:
  Directory '/opt/pacbio/smrtlink/userdata/jobs_root.default' does not exist.  Create it? [Y/n]: Y

    Creating directory '/opt/pacbio/smrtlink/userdata/jobs_root.default'...

tmp_dir - This directory is used for fast I/O operations, and should
          be located on a high performance file system available on the
          SMRT Link host and on each compute cluster node individually.
          Typically, it should be a local (not shared) disk partition.
          The recommended size size is 1TB (500GB minimum).  If the
          directory location does not exist, a directory will be
          automatically created.

  Enter the full path to the 'tmp_dir' directory [/tmp/smrtlink]:
  Directory '/tmp/smrtlink' does not exist.  Create it? [Y/n]: Y

    Creating directory '/tmp/smrtlink'...

Using jobs_root (computed default, accepted): /opt/pacbio/smrtlink/userdata/jobs_root.default
Using tmp_dir (default, accepted): /tmp/smrtlink


----- Part 7 of 10: Remote Service Setup -----

The 'SMRT Link Event Service' provides the ability to send PacBio the
following SMRT Link information:

    1) installation troubleshooting logs
    2) analysis failure logs
    3) usage information (sample names and sequence data excluded)

Note: 'SMRT Link Event Service' will be configured in the SMRT Link UI,
      upon first access after install or upgrade.

The 'SMRT Link Update Service' will provide automatic notification and
prompt for installation of SMRT Link update bundles.   Currently,
updates of the SMRT Link UI Bundle and the SMRT Link Chemistry Bundle
are supported.  The SMRT Link Chemistry Bundle will enable the use of
new PacBio consumables.

  Checking remote service URLs...
    Checking SMRT Link Event Service URL... ok
    Checking SMRT Link Update Service URL... unavailable

    Checking internet connection... ok

  The following URL is unavailable:

    SMRT Link Update Service: https://smrtlink-update.pacbcloud.com:443/status

  Test Command:

    /opt/pacbio/smrtlink/install/smrtlink-release_12.0.0.177059/bundles/smrttools/current/private/thirdparty/curl/curl_7.78.0/binwrap/curl --max-time 5 --head --fail --insecure "https://smrtlink-update.pacbcloud.com:443/status"

    WARNING - Connection with PacBio Update Service failed. You can install
              SMRT Link, but you will not be able to receive notifications
              for chemistry updates through SMRT Link.  Consult the Network
              Diagram in the Site Preparation Guide and ask your network
              administrator to open outbound connections to:
                  https://smrtlink-update.pacbcloud.com:443

There appears to be a connection to the internet, but the remote server
is temporarily unavailable.

If the Update Server will not be accessible to SMRT Link, then the
'SMRT Link Update Service' should be disabled by answering 'N' to the
following question.

  Enable the 'SMRT Link Update Service'? [Y/n]: N

Using 'SMRT Link Update Service' Enable (configured interactively): false


----- Part 8 of 10: SMRT Link Analysis Job Email Notification -----

SMRT Link can be configured to send email notifications of completed
analysis jobs to the user who launched the analysis (for both
successful and failed jobs).

SMRT Link only supports connections to SMTP Relays without encryption.
Servers using basic authentication, SSL/TLS, or STARTTLS are not
supported.

Email notification is disabled if the outgoing mail server host is
empty.

Configure the SMTP mail host and port settings below.

  Enter the SMRT Link notification outgoing mail server host []:

    No mail host specified.  SMRT Link mail notification disabled.

Using SMRT Link notification outgoing mail server host (default, accepted):
Using SMRT Link notification mail port (default): 25


----- Part 9 of 10: SMRT Link Compute Configuration  -----

SMRT Link allows for one or more compute configurations to be
defined for processing analysis jobs.  Each compute configuration
can specify unique workflow and Job Management System settings,
independent from other compute configurations.

When configuring a SMRT Analysis job, a drop-down menu under
the "Advanced Parameter Settings" allows selection of multiple
compute configurations. The selected configuration will be used
for all JMS cluster submissions for that analysis job.


Configuring 'SMRT Analysis Compute Configuration' (computecfg_00)
-----------------------------------------------------------------

NAME - Specifies a unique name for the compute configuration.

  Enter the compute config 'NAME' [SMRT Analysis Compute Configuration]:

NPROC - Specifies the maximum number of slots each task may request
        upon job submissions to a JMS cluster.  One processor core
        per slot is assumed.

  Enter the number of processors per task 'NPROC' [7]:

MAXCHUNKS - Specify the maximum number of parallel chunks when
            breaking up large dataset files.

  Enter the number of parallel chunks per task 'MAXCHUNKS' [24]:

Specify the global 'concurrent_job_limit' for Cromwell.  This is the
maximum number of simultaneous jobs that Cromwell can submit to the
compute cluster.

  Select the Cromwell concurrent_job_limit: [500]:

A Job Management System may be used to dispatch jobs to a distributed
compute environment.  If no Job Management System is specified, the
system will run in Non-Distributed Mode and all compute jobs will be
run locally on the install host.  Available Job Management Systems
will be detected from the PATH environment variable, but may also
be selected manually.

  Auto-detected the following Job Management Systems:

      NONE        (No JMS Detected)

Pick an option:
    1) None (Non-Distributed Mode)
    2) Other JMS
Choice [1]:

Using NAME (computed default, accepted): SMRT Analysis Compute Configuration
Using MENUORDER (computed default): 1
Using NPROC (default, accepted): 7
Using MAXCHUNKS (default, accepted): 24
Using Cromwell Log Level (default): INFO
Using Cromwell concurrent_job_limit (default, accepted): 500
Using jmstype (selected interactively): NONE

Current compute configurations:

    SMRT Analysis Compute Configuration (computecfg_00) [default]

Modify or add compute configuration? [N/y]: N


----- Part 10 of 10: SMRT Link Analysis Configuration  -----

NWORKERS - Specifies the maximum number of simultaneous SMRT Analysis
           workflows that can be run by the SMRT Link server.  This
           should be set to no more than the number of processors
           available on the SMRT Link install machine.  The default
           is the min of 32 and number of processors on the system.

  Enter the max number of workers 'NWORKERS' [8]:

Using NWORKERS (computed default, accepted): 8

Updating smrtlink install configuration...
Create system info logs...

Applying settings...
  Applying JMS settings....
    Applying computecfg_00 settings...
      Generating cromwell_00.json ...
    Creating user.jmsenv.ish file...
  Applying smrtlink settings....
    Creating smrtlink-system-config.json...
  Applying cromwell settings....
    Creating cromwell.conf...
      Applying JMS settings to cromwell config...
    Creating cromwell_cli.conf...
      Applying JMS settings to cromwell config...
  Applying dirlinks settings....
  Applying database settings....
Installing settings...
    Installing generated configs...
    Installing smrtlink-system-config.json...
    Validating smrtlink-system-config.json...

Running services and ui upgrade...
  Running smrtlink-analysisservices-gui upgrade...
    Installing replacement 404 redirect...
    Running apply-config...
    Setting up database...
    Starting database...
    Stopping database...
  Creating smrtlink smrtcmds links....
  Updating top level smrtcmds link....
  Installing manifests....

SMRT Link Install successful.
